import{d as e,c as t,a as i,t as a,w as s,p as n,b as o,o as r,r as d,F as l,e as c,S as h,U as m,f as p,g as u,V as g,h as v,G as w,i as _,D as f,j as x,M as S,B as b,A as y,k as L,l as P,O as A,m as R,P as M,C as E,n as I,q as F,s as z,W as T,u as C,v as D,x as O,T as q,E as k,y as N,z as j,H,I as G,J as W}from"./vendor.521ae778.js";var V=e({name:"PartInfoPanel",props:{partInfo:{type:Object,required:!0},material:{type:String,default:"-"}},setup:(e,t)=>({count:0}),methods:{updateModel(){console.log("MODEL UPDATED")},createDataString(e){let t="N/A";return e&&(t=e+this.partInfo.unit),t}}});const U=s();n("data-v-17a5d565");const B={id:"part_info_panel"},J=i("img",{id:"axiom_logo",src:"/cad-3d-viewer/prototype/assets/axiom_logo.69b92a00.png"},null,-1),X={id:"part_name"},Z=i("div",{id:"camera_name"}," AXIOM BETA ",-1),K=i("div",{id:"part_info",style:{"grid-column":"2"}},[i("span",{id:"part_header"},"PART"),i("span",null,"REVISION")],-1),Q={style:{"grid-column":"2/2","font-size":"1.4vw","text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap"}},Y={style:{"font-weight":"bold","margin-right":"0.5em"}},$={id:"part_data"},ee=i("div",null,"length:",-1),te=i("div",null,"width:",-1),ie=i("div",null,"height:",-1),ae=i("div",null,"material:",-1),se={class:"bold_text"},ne={class:"bold_text"},oe={class:"bold_text"},re={class:"bold_text"},de=i("a",{id:"apertus_link",href:"http://www.apertus.org",target:"_blank"},"www.apertus.org",-1);o();const le=U(((e,s,n,o,d,l)=>(r(),t("div",B,[J,i("div",X,[Z,K,i("div",Q,[i("span",Y,a(e.partInfo.name),1),i("span",null,a(e.partInfo.revision),1)])]),i("div",$,[ee,te,ie,ae,i("div",se,a(e.createDataString(e.partInfo.length)),1),i("div",ne,a(e.createDataString(e.partInfo.width)),1),i("div",oe,a(e.createDataString(e.partInfo.height)),1),i("div",re,a(e.partInfo.material||"-"),1)]),de]))));V.render=le,V.__scopeId="data-v-17a5d565";var ce=e({name:"PartList",props:{parts:{type:Array,required:!0}},setup:()=>({selectedIndex:d(0)}),methods:{nextModel(){this.emitter.emit("nextModel")},updateSelected(e,t){this.selectedIndex=t,this.emitter.emit("update_selected_model",t)},GetIcon(e){console.log("GET ICON"),console.log(e);let t="assets/models/"+e+"/icon.png";return void 0===e&&(console.log("ICON NOT FOUND"),t="assets/icons/dummy_icon.png"),t}}});const he=s();n("data-v-5a8e1ec0");const me={style:{overflow:"hidden",height:"100%"}},pe={class:"part_list"},ue={style:{background:"#413f3d",width:"100%",height:"100%","justify-content":"center","font-size":"0.75em",display:"flex"}};o();const ge=he(((e,s,n,o,d,h)=>(r(),t("div",me,[i("div",pe,[(r(!0),t(l,null,c(e.parts,((s,n)=>(r(),t("div",{key:s,class:["part_entry",{active:n===e.selectedIndex}],onClick:t=>e.updateSelected(s,n)},[i("img",{class:"part_thumbnail",src:"assets/models/parts/"+s.id+"/icon.png",onerror:"this.src='assets/icons/dummy_icon.png';"},null,8,["src"]),i("div",null,a(s.name),1)],10,["onClick"])))),128))]),i("div",ue,[i("div",null,a(e.selectedIndex+1)+" of "+a(e.parts.length),1)])]))));ce.render=ge,ce.__scopeId="data-v-5a8e1ec0";const ve=[u.common,u.envmap_pars_vertex,u.envmap_vertex,"uniform float time;\nuniform vec2 resolution;\n\nvoid main(){\n    gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);\n}"].join("\n"),we=[u.common,u.envmap_pars_fragment,u.envmap_fragment,"uniform float time;\nuniform vec2 resolution;\n\nvoid main()\t{\n    float x = mod(time + gl_FragCoord.x, 20.) < 10. ? 1. : 0.;\n    float y = mod(time + gl_FragCoord.y, 20.) < 10. ? 1. : 0.;\n    /*gl_FragColor = vec4(vec3(min(x, y)), 1.);*/\n    gl_FragColor = vec4(0.5, 0.5, 0.5, 1.0);\n}"].join("\n"),_e={time:{type:"f",value:1},resolution:{type:"v2",value:new g}};_e.resolution.value.x=300,_e.resolution.value.y=300,new h({uniforms:m.merge([p.fog,_e]),vertexShader:ve,fragmentShader:we});class fe extends v{constructor(e){super(),this.material={color:11645361,roughness:.2,metalness:.9,reflectivity:0,clearcoat:.6,clearcoatRoughness:.6},this.gltfLoader=new w,this.lightTargetPosition=new _(.1,0,-.1),this.currentModelCenter=new _(0,0,0),f.onLoad=()=>{e.emit("scene_loaded")},this.SetupLight(),this.LoadEnvironment()}SetupLight(){const e=new x(16777215,3,2,S.degToRad(20),.3);e.position.set(.4,.4,.7),e.target.position.copy(this.lightTargetPosition),this.add(e.target),e.castShadow=!0,e.shadow.mapSize.width=2048,e.shadow.mapSize.height=2048,e.shadow.camera.near=.5,e.shadow.camera.far=2,e.shadow.radius=8,this.add(e),e.shadow.bias=-.001;const t=new x(16777215,7,2,S.degToRad(25),.3);t.position.set(-.4,.45,-.2),t.target.position.copy(this.lightTargetPosition),this.add(t.target),t.castShadow=!0,t.shadow.mapSize.width=2048,t.shadow.mapSize.height=2048,t.shadow.camera.near=.5,t.shadow.camera.far=2,t.shadow.radius=8,t.shadow.bias=-.001,this.add(t);const i=new x(16777215,3,3,S.degToRad(15),.5);i.position.set(.8,.4,-2),i.target.position.copy(this.lightTargetPosition),this.add(i.target),i.castShadow=!0,i.shadow.mapSize.width=2048,i.shadow.mapSize.height=2048,i.shadow.camera.near=.5,i.shadow.camera.far=2,i.shadow.radius=8,i.shadow.bias=-.001,this.add(i)}LoadGLTF(e,t){this.gltfLoader.load(e,t,(function(t){console.log(e+": "+t.loaded/t.total*100+"% loaded")}),(function(e){console.error(e)}))}LoadEnvironment(){this.LoadGLTF("./assets/models/environment/environment_V02.gltf",(e=>{const t=e.scene;t.traverse((function(e){e.isMesh&&(console.info("Enable shadow cast/receive"),e.castShadow=!0,e.receiveShadow=!0,e.material.map&&(e.material.map.anisotropy=16))})),this.add(t)}))}LoadModel(e){this.remove(this.currentModel);const t="assets/models/"+e;this.LoadGLTF(t,(e=>{const t=e.scene;this.currentModel=t;const i=(new b).setFromObject(t),a=Math.abs(i.min.x),s=Math.abs(i.min.y),n=Math.abs(i.max.z);t.position.set(a,s,-n);const o=(i.max.x-i.min.x)/2,r=(i.max.y-i.min.y)/2,d=(i.min.z-i.max.z)/2;this.currentModelCenter.set(o,r,d);const l=new _(o,r,d);new y(new _(0,1,0),l,.1,16776960),new L(t,16776960),t.traverse((e=>{if(e.isMesh){e.castShadow=!0,e.receiveShadow=!0;const t=new P({color:this.material.color});t.roughness=this.material.roughness,t.metalness=this.material.metalness,t.reflectivity=this.material.reflectivity,t.clearcoat=this.material.clearcoat,t.clearcoatRoughness=this.material.clearcoatRoughness,e.material=t}})),this.add(t)}))}}class xe extends v{constructor(e,t){super(),this.camera=new A(e/-2,e/2,t/2,t/-2,-1e4,1e4),this.camera.position.z=100,this.add(this.camera),this.quad=new R(new M(window.innerWidth,window.innerHeight)),this.quad.position.z=-500,this.add(this.quad)}}class Se{constructor(e,t){this.clock=new E,this.isRenderingActive=!1,this.animationEnabled=!1,this.RenderFrame=()=>{this.isRenderingActive=!1,this.renderer.render(this.scene,this.camera)},this.container=e,this.isRenderingActive=!1,N.enabled=!0,this.SetupRenderer();const i=this.container.clientWidth/this.container.clientHeight;this.cameraTargetPosition=new _(0,.06,0),this.SetupCamera(i),this.SetupScene(t),this.SetupPostProcessingScene(),this.SetupHDR()}SetupScene(e){this.scene=new fe(e),e.on("scene_update_required",(()=>{console.log("SCENE UPDATE"),this.RequestFrame()}))}SetupPostProcessingScene(){this.postprocessingScene=new xe(this.container.clientWidth,this.container.clientHeight)}UpdateCameraTarget(){this.currentAnim&&this.currentAnim.reset(),this.currentAnim=I({duration:1e3,begin:()=>{this.startPosition=this.controls.target,this.EnableAnimationLoop()},complete:()=>{this.DisableAnimationLoop(),this.currentAnim=null},update:e=>{this.startPosition.lerp(this.scene.currentModelCenter,e.progress/100),this.camera.lookAt(this.startPosition)}})}SetupCamera(e){this.camera=new F(75,e,.01,1e3),this.camera.position.set(-.1,.2,.2),this.camera.lookAt(this.cameraTargetPosition),this.camera.setFocalLength(85),this.camera.updateProjectionMatrix(),this.controls=new z(this.camera,this.renderer.domElement),this.controls.target.copy(this.cameraTargetPosition),this.controls.maxPolarAngle=Math.PI/2,this.controls.update(),this.controls.addEventListener("change",(()=>{this.RequestFrame()}))}SetupRenderer(){this.renderer=new T({antialias:!0}),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.renderer.physicallyCorrectLights=!0,this.renderer.toneMapping=C,this.renderer.toneMappingExposure=1,this.renderer.outputEncoding=D,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=O,console.log("WebGL2: "+this.renderer.capabilities.isWebGL2),this.container.appendChild(this.renderer.domElement)}SetupHDR(){const e=(new q).load("assets/textures/hdri/abstract_room.png");e.mapping=k,e.encoding=D,this.scene.environment=e}LoadModel(e){this.scene.LoadModel(e),this.UpdateCameraTarget()}Resize(e,t){console.log("RENDERER RESIZE: "+e+" / "+t),this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t),this.RequestFrame()}EnableAnimationLoop(){console.log("ENABLE ANIM LOOP"),this.renderer.setAnimationLoop((()=>{requestAnimationFrame(this.RenderFrame)}))}DisableAnimationLoop(){console.log("DISABLE ANIM LOOP"),this.renderer.setAnimationLoop(null)}RequestFrame(){this.isRenderingActive||(this.isRenderingActive=!0,requestAnimationFrame(this.RenderFrame))}}var be=e({name:"RenderPanel",props:{part:{type:Object,required:!0}},setup:(e,t)=>({container:d(),viewer:d()}),mounted(){j((()=>this.part),((e,t)=>{console.log("PART CHANGE parts/"+e.id+"/"+e.modelFile),this.viewer.LoadModel("parts/"+e.id+"/"+e.modelFile)})),this.viewer=new Se(this.container,this.emitter),this.viewer.LoadModel("parts/"+this.part.id+"/"+this.part.modelFile),window.addEventListener("resize",(()=>{this.onResize()}))},methods:{onResize(){console.log(this.container),this.container.clientWidth&&this.container.clientHeight&&this.viewer.Resize(this.container.clientWidth,this.container.clientHeight)}}});const ye={ref:"container",style:{background:"red",width:"100%, height: 100%"}};be.render=function(e,i,a,s,n,o){return r(),t("div",ye,null,512)};var Le=[{name:"Compact Enclosure Cap Bottom",modelFile:"cap_bottom_v5.glb",id:"cap_bottom_v5",revision:" V5",unit:"mm",length:"123",width:"58",height:"24",material:"aluminium",shader:"aluminum_anodized_natural"},{name:"E-Mount Lenscap",id:"axiom_lens_cap_v01",modelFile:"axiom_lens_cap_v01.glb",revision:"V1",unit:"mm",length:"64",width:"",height:"11",material:"PLA",shader:"plastic_black"},{name:"E-Mount",id:"axiom_e_mount_v4",modelFile:"axiom_e_mount_v4.glb",revision:"V4",unit:"mm",length:"66",width:"66",height:"7.8",material:"aluminium",shader:"aluminum_anodized_black"}],Pe={name:"App",components:{PartInfoPanel:V,PartList:ce,RenderPanel:be},setup:()=>({parts:d(Le),selectedIndex:d(0)}),created(){this.emitter.on("update_selected_model",(e=>{this.selectedIndex=e}))}};const Ae={style:{display:"grid","grid-template-columns":"0.75fr 2.5fr 5fr",height:"100%"}};Pe.render=function(e,a,s,n,o,d){const l=H("PartList"),c=H("PartInfoPanel"),h=H("RenderPanel");return r(),t("div",Ae,[i(l,{parts:n.parts},null,8,["parts"]),i(c,{"part-info":n.parts[n.selectedIndex]},null,8,["part-info"]),i(h,{part:n.parts[n.selectedIndex]},null,8,["part"])])};const Re=W(),Me=G(Pe);Me.config.globalProperties.emitter=Re,Me.mount("#app");
